<!doctype html>
<html lang="no">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Nkant – én SVG med flere figurer</title>
  <link
    rel="icon"
    type="image/svg+xml"
    href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Crect width='64' height='64' rx='12' fill='%23eef2ff'/%3E%3Cpolygon points='32 10 50 24 42 54 22 54 14 24' fill='%23343685'/%3E%3Cline x1='22' y1='54' x2='42' y2='54' stroke='%230f172a' stroke-width='2'/%3E%3C/svg%3E"
  />
  <link rel="stylesheet" href="/base.css" />
  

<style>
    :root {
      --sidebar-width: 480px;
      --figure-available-height: calc(100vh - 200px);
    }
    .card--figure {
      padding: 14px;
      width: fit-content;
      max-width: 100%;
      justify-self: start;
      align-items: center;
    }
    .card--figure .figure {
      border-radius: 12px;
      background: #fff;
      overflow: auto;
      border: 1px solid #e5e7eb;
      resize: both;
      min-width: 240px;
      min-height: 200px;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 12px;
      width: fit-content;
      max-width: 100%;
    }
    .figure svg {
      width: min(
        100%,
        max(
          240px,
          calc(var(--figure-available-height, calc(100vh - 200px)) * (600 / 420))
        )
      );
      height: auto;
      max-height: 100%;
      display: block;
    }
    .specs-row { display:flex; gap:10px; align-items:flex-start; }
    .specs-row textarea { flex:1; width:auto; }
    textarea, select, input[type="text"] { width: 100%; }
    .small { font-size: 12px; color: #6b7280; }
    .sep { height: 1px; background: #eef0f3; margin: 8px 0; }
    .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
    @media (max-width: 600px) { .form-row { grid-template-columns: 1fr; } }
    .grid-3 {
      display: grid;
      grid-template-columns: repeat(2, minmax(72px, 1fr));
      gap: 4px;
      align-items: center;
    }
    .figure-controls { display: grid; gap: 10px; }
    .figure-controls__header { display: flex; align-items: baseline; justify-content: space-between; gap: 10px; }
    .figure-list { display: grid; gap: 12px; }
    .figure-config { border: 1px solid #e5e7eb; border-radius: 12px; padding: 12px; background: #f9fafb; display: grid; gap: 10px; }
    .figure-config__header { display: flex; justify-content: space-between; align-items: center; }
    .figure-config__remove { color: #6b7280; background: transparent; border: none; padding: 6px 8px; }
    .figure-config__draw { align-self: start; }
    .figure-actions { display: flex; align-items: center; gap: 10px; flex-wrap: wrap; }
    .form-row--compact { grid-template-columns: 1fr; }
    .addFigureBtn { width: 44px; aspect-ratio: 1; border: 2px dashed #cfcfcf; border-radius: 10px; background: #fff; display: flex; align-items: center; justify-content: center; font-size: 20px; color: #6b7280; cursor: pointer; transition: box-shadow .2s, transform .02s; }
    .addFigureBtn:hover { box-shadow: 0 2px 8px rgba(0,0,0,.06); }
    .addFigureBtn:active { transform: translateY(1px); }
    .legend { font-weight: 600; font-size: 13px; color: #374151; margin-top: 8px; }
    .radio-row { display: flex; gap: 14px; align-items: center; }
    .tight { padding: 4px 8px; width: 44px; }
    .grid-3 .tight { width: 100%; }
    input[type="text"]:disabled { background: #f3f4f6; color: #9ca3af; }
    .setting__details {
      margin-top: 8px;
      border: 1px solid #e5e7eb;
      border-radius: 10px;
      background: #f9fafb;
    }
    .setting__details summary {
      list-style: none;
      cursor: pointer;
      padding: 6px 10px;
      margin: 0;
      font-size: 12px;
      font-weight: 600;
      color: #4b5563;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 6px;
    }
    .setting__details summary::-webkit-details-marker { display: none; }
    .setting__details summary::after {
      content: '\25BC';
      font-size: 10px;
      color: #9ca3af;
      transition: transform .2s ease;
    }
    .setting__details[open] > summary::after { transform: rotate(180deg); }
    .setting__details[open] > .setting__hint-list {
      border-top: 1px solid #e5e7eb;
    }
    .setting__hint-list {
      margin: 0;
      padding: 10px 14px 12px 26px;
      font-size: 12px;
      color: #6b7280;
      display: grid;
      gap: 6px;
      list-style: disc;
    }
    .setting__hint-list--specs {
      padding-left: 30px;
      padding-right: 18px;
      color: #4b5563;
    }
    .setting__hint-list--specs code {
      font-size: 12px;
      background: #eef2ff;
      padding: 2px 4px;
      border-radius: 4px;
      color: #4338ca;
      font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;
    }
    .label-editor { display: grid; gap: 10px; }
    .label-editor--figure {
      width: 100%;
      margin-top: 10px;
      display: none;
    }
    .label-editor__controls {
      display: grid;
      gap: 10px;
      padding: 10px;
      border: 1px solid #e5e7eb;
      border-radius: 10px;
      background: #f9fafb;
    }
    .label-editor__row { display: flex; gap: 10px; align-items: center; justify-content: space-between; flex-wrap: wrap; }
    .label-editor__actions { display: flex; gap: 8px; flex-wrap: wrap; }
    .label-editor__badge {
      display: inline-block;
      padding: 4px 8px;
      border-radius: 8px;
      background: #eef2ff;
      color: #4338ca;
      font-weight: 600;
      min-width: 140px;
    }
    .label-editor__rotation {
      display: grid;
      grid-template-columns: auto 80px;
      gap: 8px;
      align-items: center;
    }
    .label-editor__rotation[hidden] { display: none !important; }
    .label-editor__rotation-hint {
      font-size: 12px;
      color: #6b7280;
      line-height: 1.5;
    }
    .label-editor__hint { margin: 0; color: #6b7280; }
    .label-rotation-handle {
      pointer-events: none;
    }
    .label-rotation-handle__line {
      stroke: #6b7280;
      stroke-width: 2;
      stroke-linecap: round;
    }
    .label-rotation-handle__knob {
      fill: white;
      stroke: #4b5563;
      stroke-width: 2;
      filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.25));
    }
    .label-rotation-handle__hit {
      fill: transparent;
      cursor: grab;
      pointer-events: all;
    }
    .label-draggable { cursor: grab; }
    .label-selected { filter: drop-shadow(0 0 4px rgba(59, 130, 246, 0.9)); }
    .global-settings { display: grid; gap: 10px; }
    .global-settings__grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }
    .global-settings__grid > div { display: grid; gap: 6px; }
    @media (max-width: 600px) {
      .global-settings__grid {
        grid-template-columns: 1fr;
      }
    }
    .checkbox-row { display: inline-flex; align-items: center; gap: 8px; font-size: 14px; }
  </style>
  <link rel="stylesheet" href="/split.css" />
</head>
<body>
  <main id="main-content" role="main" class="wrap">
    <div class="grid layout--sidebar">
      <div class="card card--figure">
        <h1 class="sr-only">Nkant – én SVG med flere figurer</h1>
        <div class="figure">
          <svg id="paper" viewBox="0 0 600 420" preserveAspectRatio="xMidYMid meet" aria-label=""></svg>
        </div>
        <div class="label-editor label-editor--figure">
          <div id="labelEditorControls" class="label-editor__controls">
            <div class="label-editor__row">
              <div>
                <div class="small">Aktiv etikett</div>
                <div id="labelEditorActive" class="label-editor__badge">Ingen valgt</div>
              </div>
              <div class="label-editor__actions">
                <button id="btnResetLabelPosition" class="btn" type="button">Tilbakestill</button>
              </div>
            </div>
            <div class="label-editor__rotation" hidden>
              <div class="label-editor__rotation-hint">
                Dra rotasjonshåndtaket ("lollipop") på etiketten for å rotere teksten.
              </div>
              <input
                id="labelRotationNumber"
                class="tight"
                aria-label="Rotasjon i grader"
                type="number"
                min="-180"
                max="180"
                value="0"
              />
            </div>
            <p class="label-editor__hint small">Dra etiketter direkte i tegningen for å flytte dem. I redigeringsmodus kan du også velge etiketter med TAB, bruke piltastene for å flytte (SHIFT for større steg, ALT/⌘ for finjustering) og [ eller - / ] eller + for å rotere.</p>
          </div>
        </div>
        </div>

      <div class="side">
        <div id="taskPanel" class="card task-panel" hidden>
          <h3>Oppgave</h3>
          <textarea id="taskModeDescription" class="task-text-editable" placeholder="Klikk her for å skrive oppgavetekst..."></textarea>
        </div>
        <div class="card card--examples">
          <div class="example-description">
            <textarea id="exampleDescription" aria-label="Oppgavetekst (valgfritt)" placeholder="Skriv oppgavetekst her"></textarea>
          </div>
          <div class="toolbar">
            <button id="btnUpdateExample" class="btn" type="button">Oppdater</button>
            <button id="btnSaveExample" class="btn" type="button">Lag nytt</button>
            <button id="btnDeleteExample" class="btn" type="button">Arkiver</button>
            <button id="btnSvg" class="btn" type="button">Eksporter</button>
          </div>
        </div>

        <div class="card card--settings">

        <div class="global-settings">
          <div class="figure-controls__header">
            <div class="legend">Globale innstillinger</div>
          </div>
          <div id="globalSettingsGrid" class="global-settings__grid">
            <div id="globalDefaultSidesWrap"></div>
            <div id="globalDefaultAnglesWrap"></div>
            <div>
              <label for="textSizeSelect">Skriftstørrelse</label>
              <select id="textSizeSelect">
                <option value="large">24 px (Stor)</option>
                <option value="medium" selected>20 px (Medium)</option>
                <option value="small">16 px (Liten)</option>
              </select>
            </div>
            <div>
              <label for="rotateTextSelect">Rotasjon</label>
              <select id="rotateTextSelect">
                <option value="rotate">Roter tekst</option>
                <option value="no-rotate">Ikke roter tekst</option>
              </select>
            </div>
          </div>
        </div>

        <div class="sep"></div>

        <div class="figure-controls">
          <div class="figure-controls__header">
            <div class="legend">Figurer</div>
            <div class="small">Maks fire figurer i 2×2-rutenett.</div>
          </div>
          <div id="figureList" class="figure-list"></div>
          <div class="figure-actions">
            <button id="btnAddFigure" class="addFigureBtn" type="button" aria-label="Legg til figur">+</button>
            <span class="small">Legg til figur</span>
            <button id="btnDraw" class="btn" type="button">Tegn alle</button>
          </div>
        </div>

        <div class="sep"></div>
      </div>
        <div class="card" id="exportCard">
          <h2>Eksporter</h2>
        </div>
    </div>
  </main>

  <script src="/palette/palette-config.js"></script>
  <script src="/palette/group-palette.js"></script>
  <script src="/palette/palette-service-client.js"></script>
  <script src="/theme/palette.js"></script>
  <script src="/theme-profiles.js"></script>
  <script src="/alt-text-ui.js"></script>
  <script src="/svg-export-helper.js"></script>
  <script src="/nkant.js"></script>
  <script src="/examples.js"></script>
  <script src="/split.js"></script>

</body>
</html>
