<!doctype html>
<html lang="no">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Trefigurer</title>
  <style>
    :root { --gap: 18px; }
    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Helvetica Neue", Arial, "Noto Sans";
      color: #111827;
      background: #f7f8fb;
      padding: 20px;
    }
    .wrap { max-width: 1200px; margin: 0 auto; }
    .grid { display: grid; gap: var(--gap); grid-template-columns: 1fr 420px; align-items: start; }
    @media (max-width: 980px) { .grid { grid-template-columns: 1fr; } }
    .side { display: flex; flex-direction: column; gap: var(--gap); }
    .card {
      background: #fff;
      border: 1px solid #e5e7eb;
      border-radius: 14px;
      box-shadow: 0 1px 2px rgba(0,0,0,.04);
      padding: 14px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .card h2 { margin: 0 0 6px 2px; font-size: 16px; font-weight: 600; color: #374151; }
    .toolbar { display: flex; gap: 10px; justify-content: flex-start; align-items: center; flex-wrap: wrap; }
    .btn {
      appearance: none;
      border: 1px solid #d1d5db;
      background: #fff;
      border-radius: 10px;
      padding: 8px 12px;
      font-size: 14px;
      cursor: pointer;
      transition: box-shadow .2s, transform .02s;
    }
    .btn:hover { box-shadow: 0 2px 8px rgba(0,0,0,.06); }
    .btn:active { transform: translateY(1px); }
    label { font-size: 13px; color: #4b5563; }
    textarea { border: 1px solid #d1d5db; border-radius: 10px; padding: 8px 10px; font-size: 14px; background: #fff; width: 100%; }
    .specs-row { display: flex; gap: 10px; align-items: flex-start; }
    .specs-row textarea { flex: 1; }
    .small { font-size: 12px; color: #6b7280; }
    .figure-grid {
      --figure-columns: 1;
      display: grid;
      gap: var(--gap);
      grid-template-columns: repeat(var(--figure-columns), minmax(0, 1fr));
      align-items: stretch;
    }
    .figure-grid[data-figures="2"] { --figure-columns: 2; }
    .figure {
      position: relative;
      border-radius: 12px;
      border: 1px solid #eef0f3;
      background: #fdfdfe;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      min-height: 0;
    }
    .figure.is-hidden { display: none; }
    .figureCanvas {
      position: relative;
      flex: 0 0 auto;
      min-height: 320px;
      aspect-ratio: 4 / 3;
    }
    .figureCanvas canvas { width: 100%; height: 100%; display: block; }
    @media (max-width: 720px) {
      .grid { grid-template-columns: 1fr; }
      .figure-grid { --figure-columns: 1; }
      .figureCanvas { min-height: 280px; }
    }
    .option-row {
      margin-top: 10px;
    }
    .option-row__header {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }
    .option-row--color {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: space-between;
      align-items: center;
    }
    .option-row--slider {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    .option-hint {
      font-size: 12px;
      color: #6b7280;
    }
    .color-controls {
      display: inline-flex;
      gap: 8px;
      align-items: center;
    }
    .color-input {
      width: 44px;
      height: 28px;
      border: 1px solid #d1d5db;
      border-radius: 8px;
      padding: 0;
      background: #fff;
      cursor: pointer;
    }
    .color-input.is-auto {
      opacity: 0.6;
    }
    .range-input {
      width: 100%;
      accent-color: #3b82f6;
    }
    .btn--small {
      padding: 6px 10px;
      font-size: 12px;
    }
    .btn--small:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    .checkbox {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      font-size: 13px;
      color: #4b5563;
      cursor: pointer;
      user-select: none;
    }
    .checkbox input {
      width: 16px;
      height: 16px;
      accent-color: #3b82f6;
    }
    .checkbox span {
      line-height: 1.3;
    }
    .card--export h2 {
      margin-bottom: 4px;
    }
    .export-row {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }
    .export-row + .export-row {
      margin-top: 10px;
      padding-top: 10px;
      border-top: 1px solid #e5e7eb;
    }
    .export-row__header {
      display: flex;
      flex-wrap: wrap;
      gap: 8px 12px;
      justify-content: space-between;
      align-items: center;
    }
    .export-row__title {
      font-size: 13px;
      font-weight: 600;
      color: #374151;
    }
    .export-buttons {
      display: inline-flex;
      flex-wrap: wrap;
      gap: 8px;
    }
    .export-row.is-hidden {
      display: none;
    }
  </style>
  <link rel="stylesheet" href="split.css" />
</head>
<body>
  <div class="wrap">
    <div class="grid">
      <div class="card">
        <div id="figureGrid" class="figure-grid" data-figures="1">
          <div class="figure" data-figure-index="0">
            <div class="figureCanvas" id="figure0"></div>
          </div>
          <div class="figure is-hidden" data-figure-index="1">
            <div class="figureCanvas" id="figure1"></div>
          </div>
        </div>
      </div>
      <div class="side">
        <div class="card card--examples">
          <div class="toolbar">
            <button id="btnSaveExample" class="btn" type="button">Lagre eksempel</button>
            <button id="btnDeleteExample" class="btn" type="button">Slett eksempel</button>
          </div>
        </div>
        <div id="exportCard" class="card card--export">
          <h2>Eksporter figurer</h2>
          <div class="export-row" data-export-index="0">
            <div class="export-row__header">
              <span class="export-row__title" data-export-label>Figur 1</span>
              <div class="export-buttons">
                <button class="btn btn--small" type="button" data-export-button data-export-format="png" data-figure-index="0">Last ned PNG</button>
                <button class="btn btn--small" type="button" data-export-button data-export-format="svg" data-figure-index="0">Last ned SVG</button>
              </div>
            </div>
          </div>
          <div class="export-row" data-export-index="1">
            <div class="export-row__header">
              <span class="export-row__title" data-export-label>Figur 2</span>
              <div class="export-buttons">
                <button class="btn btn--small" type="button" data-export-button data-export-format="png" data-figure-index="1">Last ned PNG</button>
                <button class="btn btn--small" type="button" data-export-button data-export-format="svg" data-figure-index="1">Last ned SVG</button>
              </div>
            </div>
          </div>
        </div>
        <div class="card card--settings">
          <label for="inpSpecs">Skriv fritekst (én figur per linje)</label>
          <div class="specs-row">
            <textarea id="inpSpecs" rows="4" spellcheck="false">sylinder radius: r høyde: h</textarea>
            <button id="btnDraw" class="btn" type="button">Tegn</button>
          </div>
          <div class="small">Bruk ordene <strong>prisme</strong>, <strong>trekantet sylinder</strong>, <strong>firkantet sylinder</strong>, <strong>pyramide</strong> eller <strong>kule</strong>.</div>
          <div class="small">Legg til <strong>radius</strong> og/eller <strong>høyde</strong> i linjen for å vise mål, for eksempel <code>sylinder radius: r høyde: h</code>.</div>
          <div class="small">Du kan bruke <code>:</code> eller <code>=</code>, og skrive egen tekst (bruk gjerne anførselstegn om teksten har mellomrom). Lar du teksten stå tom, vises bare streken.</div>
          <div class="small">Trykk Ctrl+Enter (eller ⌘+Enter) for å tegne mens du skriver.</div>
          <div class="small">Dra i figuren for å rotere. Bruk høyre museknapp (eller to fingre) for å panorere og rullehjul eller pinch for å zoome.</div>
          <div class="option-row option-row--color">
            <div class="option-row__header">
              <label for="inpColor">Farge</label>
              <div class="option-hint">Gjelder alle figurer. Nullstill for å bruke standardfargen.</div>
            </div>
            <div class="color-controls">
              <input id="inpColor" class="color-input" type="color" value="#3b82f6" aria-label="Velg farge" />
              <button id="btnResetColor" class="btn btn--small" type="button">Nullstill</button>
            </div>
          </div>
          <div class="option-row option-row--slider">
            <div class="option-row__header">
              <label for="rngTransparency">Gjennomsiktighet: <span id="lblTransparency">0%</span></label>
              <div class="option-hint">0% er helt tett, 90% er svært gjennomsiktig.</div>
            </div>
            <input id="rngTransparency" class="range-input" type="range" min="0" max="90" step="5" value="0" />
          </div>
          <div class="option-row option-row--checkbox">
            <label class="checkbox">
              <input id="chkLockRotation" type="checkbox" />
              <span>Lås rotasjonen</span>
            </label>
          </div>
          <div class="option-row option-row--checkbox">
            <label class="checkbox">
              <input id="chkFreeFigure" type="checkbox" />
              <span>Fri figuren</span>
            </label>
          </div>
        </div>
      </div>
    </div>
  </div>
  <script src="https://unpkg.com/three@0.158.0/build/three.min.js"></script>
  <script
    src="vendor/three/examples/js/controls/OrbitControls.js"
    data-orbit-controls
    onload="this.dataset.loaded='true'"
    onerror="this.dataset.loaded='false'"
  ></script>
  <script src="trefigurer.js"></script>
  <script src="examples.js"></script>
  <script src="split.js"></script>
</body>
</html>
